---
title: "Poverty and Income Inequality in Scotland `r params$data_period`" 
subtitle: "A National Statistics publication"
date: "Published on `r params$pub_day`"

output:
  bookdown::html_document2:
    number_sections: false
    fig_width: 7
    fig_height: 3
    toc: yes
    toc_depth: 2
    toc_float:
      collapsed: yes
      smooth_scroll: no

params:
  pub_day: "26 March 2020"
  data_period: "2016-19"
  data_year: "2018/19"
---
  
<!-- Include logo and skip target at the top of the document -->
  
<script>
  $(document).ready(function(){
    $head = $('#header');
    $head.prepend('<img src=\"img/badge.png\" alt=\"National Statistics logo\" id=\"badge\"/></a><div class=\"skiptarget\"><a id=\"maincontent\">-</a></div>')
    });
</script>
  

```{r setup, include = FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE
)

knitr::opts_knit$set(root.dir = rprojroot::find_rstudio_root_file())

```

```{r}

library(tidyverse)
library(scales)
library(kableExtra)
library(htmltools)
library(ggiraph)

source("R/00_colours.R")

povertycharts <- readRDS("data/povertycharts.rds")
povertytables <- readRDS("data/povertytables.rds")

infobox <- function(md) {
  div(class = "ds_inset-text",
      div(class = "ds_inset-text__text",
          create_html(md)))
}

message <- function(md) {
  div(class = "message-text",
      div(class = "message-text__text",
          create_html(md)))
}

devnote <- function(md) {
  div(class = "devnote-text",
      div(class = "devnote-text__text",
          create_html(md)))  
}

create_html <- function(md) {
  htmltools::HTML(
    markdown::markdownToHTML(
      text = md, fragment.only = TRUE
    )
  )
}

interactive <- function(chart, height = 3) {
  chart <- girafe(ggobj = chart, width = 1, height_svg = height, width_svg = 7)
  girafe_options(x = chart, 
               opts_hover(css = "fill: #fdd522; stroke: gray; fill-opacity: 1; stroke-opacity: 1"))
}

# Theme ----

mytheme <- theme_grey() +
  theme(text = element_text(colour = SGgreys[1], size = 14),

        line = element_line(colour = SGgreys[1],
                            linetype = 1,
                            lineend = 2,
                            size = 0.5),

        plot.title = element_text(hjust = 0, colour = SGgreys[1]),
        plot.subtitle = element_text(hjust = 0, colour = SGgreys[1]),
        plot.caption = element_text(hjust = 1),

        legend.position = "top",
        legend.title = element_blank(),

        panel.background = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),

        axis.line.x = element_line(),
        axis.ticks.length = unit(2, "pt"),
        axis.ticks.y = element_blank(),

        axis.title = element_blank(),
        axis.text.y = element_blank())

theme_set(mytheme)

```


```{r child = "_poverty_chapters/_chapter01.Rmd"}
```

```{r child = "_poverty_chapters/_chapter02.Rmd"}
```

```{r child = "_poverty_chapters/_chapter03.Rmd"}
```

```{r child = "_poverty_chapters/_chapter04.Rmd"}
```

```{r child = "_poverty_chapters/_chapter05.Rmd"}
```

```{r child = "_poverty_chapters/_chapter06.Rmd"}
```

```{r child = "_poverty_chapters/_chapter07.Rmd"}
```

```{r child = "_poverty_chapters/_chapter08.Rmd"}
```

```{r child = "_poverty_chapters/_chapter09.Rmd"}
```

```{r child = "_poverty_chapters/_chapter10.Rmd"}
```

```{r child = "_poverty_chapters/_chapter11.Rmd"}
```

